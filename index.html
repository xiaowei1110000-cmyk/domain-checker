<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ ä¸“ä¸šåŸŸåæ•…éšœè¯Šæ–­ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7e22ce 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .input-section {
            padding: 40px;
            background: #f8fafc;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto 20px;
        }
        
        input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
        }
        
        input:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        button {
            background: linear-gradient(135deg, #4f46e5 0%, #7e22ce 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 140px;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .test-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .test-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .test-checkbox input {
            width: auto;
        }
        
        .results {
            padding: 0 40px 40px;
            min-height: 200px;
        }
        
        .test-item {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            border-left: 5px solid #e2e8f0;
            transition: all 0.3s;
        }
        
        .test-item.success {
            border-left-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .test-item.error {
            border-left-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        }
        
        .test-item.warning {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }
        
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .test-title {
            font-size: 18px;
            font-weight: 600;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .status-success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-error {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .status-warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .test-details {
            color: #475569;
            line-height: 1.6;
            font-family: 'Consolas', 'Monaco', monospace;
            background: rgba(255,255,255,0.7);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 14px;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .summary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .summary h3 {
            font-size: 20px;
            margin-bottom: 15px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
            display: none;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-list {
            background: #fef2f2;
            border: 2px solid #ef4444;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .error-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #ef4444;
        }
        
        .recommendations {
            background: #dbeafe;
            border: 2px solid #3b82f6;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .whois-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .whois-table th, .whois-table td {
            border: 1px solid #e2e8f0;
            padding: 12px 15px;
            text-align: left;
            font-size: 13px;
        }
        
        .whois-table th {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            font-weight: 600;
            color: #475569;
            white-space: nowrap;
            width: 140px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .expiring-soon {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%) !important;
            color: #dc2626 !important;
            font-weight: bold;
            border-left: 3px solid #ef4444 !important;
        }
        
        .ssl-info {
            margin-top: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-radius: 8px;
            border: 1px solid #a7f3d0;
        }
        
        .ssl-date-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 6px 0;
            border-bottom: 1px dashed #d1fae5;
        }
        
        .ssl-date-label {
            font-weight: 600;
            color: #065f46;
            font-size: 13px;
        }
        
        .ssl-date-value {
            font-family: 'Consolas', 'Monaco', monospace;
            color: #047857;
            font-size: 13px;
        }
        
        .ssl-certificate-details {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .ssl-certificate-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .ssl-certificate-row:last-child {
            border-bottom: none;
        }
        
        .ssl-certificate-label {
            font-weight: 600;
            color: #475569;
            font-size: 13px;
            min-width: 120px;
        }
        
        .ssl-certificate-value {
            font-family: 'Consolas', 'Monaco', monospace;
            color: #1e293b;
            font-size: 13px;
            flex: 1;
            text-align: right;
            word-break: break-all;
        }
        
        .ssl-certificate-value.warning {
            color: #dc2626;
            font-weight: bold;
        }
        
        .ssl-certificate-value.success {
            color: #059669;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            
            .header, .input-section, .results {
                padding: 20px;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            .test-selection {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .ssl-certificate-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .ssl-certificate-value {
                text-align: left;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” ä¸“ä¸šåŸŸåæ•…éšœè¯Šæ–­ç³»ç»Ÿ</h1>
            <p>ç²¾ç¡®æ£€æµ‹åŸŸåæ— æ³•è®¿é—®çš„å…·ä½“åŸå›  | WHOISæŸ¥è¯¢ | SSLè¯ä¹¦åˆ†æ | DNSæ·±åº¦è§£æ</p>
        </div>
        
        <div class="input-section">
            <div class="input-group">
                <input type="text" id="domainInput" 
                       placeholder="è¾“å…¥è¦è¯Šæ–­çš„åŸŸåï¼ˆä¾‹å¦‚ï¼šexample.comï¼‰" 
                       value="6666.vip">
                <button id="diagnoseBtn" onclick="startDiagnosis()">å¼€å§‹å…¨é¢è¯Šæ–­</button>
            </div>
            
            <div class="test-selection">
                <label class="test-checkbox">
                    <input type="checkbox" id="checkDNS" checked> ğŸŒ DNSè§£ææ£€æµ‹
                </label>
                <label class="test-checkbox">
                    <input type="checkbox" id="checkDNSFull" checked> ğŸ” å®Œæ•´DNSè§£æ
                </label>
                <label class="test-checkbox">
                    <input type="checkbox" id="checkHTTP" checked> ğŸ”— HTTP/HTTPSæ£€æµ‹
                </label>
                <label class="test-checkbox">
                    <input type="checkbox" id="checkSSL" checked> ğŸ”’ SSLè¯ä¹¦æ£€æµ‹
                </label>
                <label class="test-checkbox">
                    <input type="checkbox" id="checkWHOIS" checked> ğŸ“‹ WHOISä¿¡æ¯
                </label>
                <label class="test-checkbox">
                    <input type="checkbox" id="checkPing" checked> ğŸ“¡ Pingæµ‹è¯•
                </label>
            </div>
            
            <div id="errorMessage" style="display:none;color:#ef4444;text-align:center;margin-top:10px;padding:10px;background:#fef2f2;border-radius:5px;"></div>
        </div>
        
        <div class="results" id="resultsContainer">
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <p>æ­£åœ¨æ‰§è¡Œæ·±åº¦è¯Šæ–­ï¼Œè¯·ç¨å€™...</p>
            </div>
        </div>
    </div>

    <script>
        class ProfessionalDomainDiagnostic {
            constructor() {
                this.domain = '';
                this.results = {};
                this.errors = [];
                this.recommendations = [];
                this.loadingElement = document.getElementById('loading');
                this.resultsContainer = document.getElementById('resultsContainer');
                this.errorMessageElement = document.getElementById('errorMessage');
                this.diagnoseBtn = document.getElementById('diagnoseBtn');
                this.isDiagnosing = false;
            }
            
            async startDiagnosis(domain) {
                if (this.isDiagnosing) return;
                this.isDiagnosing = true;
                
                try {
                    this.domain = domain;
                    this.results = {};
                    this.errors = [];
                    this.recommendations = [];
                    
                    this.loadingElement.style.display = 'block';
                    this.resultsContainer.innerHTML = '';
                    this.errorMessageElement.style.display = 'none';
                    
                    this.diagnoseBtn.textContent = 'è¯Šæ–­ä¸­...';
                    this.diagnoseBtn.disabled = true;
                    
                    const checks = [];
                    
                    if (document.getElementById('checkDNS')?.checked) {
                        checks.push(this.checkDNS());
                    }
                    
                    if (document.getElementById('checkDNSFull')?.checked) {
                        checks.push(this.fullDNSLookup());
                    }
                    
                    if (document.getElementById('checkHTTP')?.checked) {
                        checks.push(this.checkHTTP());
                    }
                    
                    if (document.getElementById('checkSSL')?.checked) {
                        checks.push(this.checkSSL());
                    }
                    
                    if (document.getElementById('checkWHOIS')?.checked) {
                        checks.push(this.checkWHOIS());
                    }
                    
                    if (document.getElementById('checkPing')?.checked) {
                        checks.push(this.checkPing());
                    }
                    
                    if (checks.length === 0) {
                        throw new Error('è¯·è‡³å°‘é€‰æ‹©ä¸€é¡¹æ£€æµ‹é¡¹ç›®');
                    }
                    
                    const results = await Promise.allSettled(checks);
                    
                    results.forEach((result) => {
                        if (result.status === 'fulfilled') {
                            const [key, data] = Object.entries(result.value)[0];
                            this.results[key] = data;
                        }
                    });
                    
                    this.analyzeFaults();
                    this.displayResults();
                    
                } catch (error) {
                    console.error('è¯Šæ–­å¤±è´¥:', error);
                    this.showError(`è¯Šæ–­å¤±è´¥: ${error.message}`);
                } finally {
                    this.loadingElement.style.display = 'none';
                    this.diagnoseBtn.textContent = 'å¼€å§‹å…¨é¢è¯Šæ–­';
                    this.diagnoseBtn.disabled = false;
                    this.isDiagnosing = false;
                }
            }
            
            showError(message) {
                this.errorMessageElement.textContent = message;
                this.errorMessageElement.style.display = 'block';
            }
            
            // 2. ä¿®å¤çš„WHOISæŸ¥è¯¢ - å¼•å¯¼åˆ°é˜¿é‡Œäº‘å®˜æ–¹æŸ¥è¯¢
            async checkWHOIS() {
                try {
                    let details = `ğŸ“‹ WHOISåŸŸåæ³¨å†Œä¿¡æ¯ (${this.domain}):\n\n`;
                    
                    // æ„å»ºè·³è½¬åˆ°é˜¿é‡Œäº‘å®˜æ–¹æŸ¥è¯¢é¡µé¢çš„é“¾æ¥
                    const aliyunWhoisUrl = `https://whois.aliyun.com/whois/domain/${this.domain}`;
                    
                    details += `<div style="background:linear-gradient(135deg,#fffbeb 0%,#fef3c7 100%);border:1px solid #fbbf24;color:#92400e;padding:20px;border-radius:8px;margin-bottom:20px;">`;
                    details += `âš ï¸ <strong>é‡è¦æç¤ºï¼šç”±äºå…¬å¼€WHOIS APIå·²å¤±æ•ˆï¼Œæ— æ³•ç›´æ¥è·å–å®æ—¶æ•°æ®ã€‚</strong><br><br>`;
                    details += `ğŸ’¡ <strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä¸ºäº†è·å¾—æœ€å‡†ç¡®ã€æƒå¨çš„åŸŸåæ³¨å†Œä¿¡æ¯ï¼Œå»ºè®®æ‚¨ç›´æ¥è®¿é—®é˜¿é‡Œäº‘ï¼ˆä¸‡ç½‘ï¼‰çš„å®˜æ–¹WHOISæŸ¥è¯¢é¡µé¢ã€‚<br><br>`;
                    details += `ğŸ”— <a href="${aliyunWhoisUrl}" target="_blank" style="background:linear-gradient(135deg,#4f46e5 0%,#7e22ce 100%);color:white;padding:10px 20px;border-radius:5px;text-decoration:none;font-weight:bold;display:inline-block;">ç‚¹å‡»å‰å¾€é˜¿é‡Œäº‘WHOISæŸ¥è¯¢</a>`;
                    details += `</div>`;
                    
                    details += `<div style="background:#f8fafc;padding:15px;border-radius:6px;border:1px solid #e2e8f0;">`;
                    details += `<strong>ä¸ºä»€ä¹ˆæ¨èé˜¿é‡Œäº‘WHOISæŸ¥è¯¢ï¼š</strong><br>`;
                    details += `â€¢ <strong>æ•°æ®æœ€å‡†ç¡®</strong>ï¼šé˜¿é‡Œäº‘æ˜¯ä¸­å›½æœ€å¤§çš„åŸŸåæ³¨å†Œå•†ï¼Œæ•°æ®ç›´æ¥æ¥è‡ªæ³¨å†Œå±€<br>`;
                    details += `â€¢ <strong>ä¿¡æ¯æœ€å®Œæ•´</strong>ï¼šåŒ…å«æ³¨å†Œäººã€æ³¨å†Œå•†ã€æ³¨å†Œ/åˆ°æœŸæ—¶é—´ã€åŸŸåçŠ¶æ€ç­‰å…³é”®ä¿¡æ¯<br>`;
                    details += `â€¢ <strong>æ›´æ–°æœ€åŠæ—¶</strong>ï¼šå®æ—¶åæ˜ åŸŸåå½“å‰çŠ¶æ€ï¼Œç‰¹åˆ«æ˜¯è¿‡æœŸæ—¶é—´<br>`;
                    details += `â€¢ <strong>æ— éœ€APIå¯†é’¥</strong>ï¼šå…è´¹å…¬å¼€æŸ¥è¯¢ï¼Œæ— ä½¿ç”¨é™åˆ¶<br>`;
                    details += `</div>`;
                    
                    details += `<div style="margin-top:15px;font-size:13px;color:#64748b;">`;
                    details += `<strong>æŸ¥è¯¢æ­¥éª¤å»ºè®®ï¼š</strong><br>`;
                    details += `1. ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æˆ–<a href="${aliyunWhoisUrl}" target="_blank" style="color:#4f46e5;">${aliyunWhoisUrl}</a><br>`;
                    details += `2. åœ¨é˜¿é‡Œäº‘é¡µé¢å®Œæˆå®‰å…¨éªŒè¯ï¼ˆå¦‚éœ€ï¼‰<br>`;
                    details += `3. æŸ¥çœ‹å®Œæ•´çš„åŸŸåæ³¨å†Œä¿¡æ¯<br>`;
                    details += `4. ç‰¹åˆ«å…³æ³¨"è¿‡æœŸæ—¶é—´"ï¼Œè¿™æ˜¯åˆ¤æ–­åŸŸåå¯ç”¨æ€§çš„å…³é”®`;
                    details += `</div>`;
                    
                    return { whois: { status: 'warning', details } };
                    
                } catch (error) {
                    console.error('WHOISæŸ¥è¯¢é”™è¯¯:', error);
                    return { 
                        whois: { 
                            status: 'error', 
                            details: `WHOISæŸ¥è¯¢é‡åˆ°é—®é¢˜: ${error.message}` 
                        } 
                    };
                }
            }
            
            // 3. å¢å¼ºçš„SSLè¯ä¹¦æ£€æµ‹ - æ˜¾ç¤ºè¯ä¹¦ç”Ÿæˆå’Œåˆ°æœŸæ—¶é—´
            async checkSSL() {
                try {
                    let details = `ğŸ” SSLè¯ä¹¦æ£€æµ‹ç»“æœ (${this.domain}):\n\n`;
                    
                    // ä½¿ç”¨TLSè¿æ¥è·å–çœŸå®çš„SSLè¯ä¹¦ä¿¡æ¯
                    const certInfo = await this.getCertificateInfo();
                    
                    if (certInfo && certInfo.success) {
                        details += `<div style="background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);padding:20px;border-radius:8px;border:1px solid #a7f3d0;">`;
                        details += `âœ… <strong>SSLè¯ä¹¦æœ‰æ•ˆ</strong><br>`;
                        details += `</div>`;
                        
                        // æ˜¾ç¤ºè¯¦ç»†çš„è¯ä¹¦ä¿¡æ¯
                        details += `<div class="ssl-certificate-details">`;
                        details += `<h4 style="color:#1e293b;margin-bottom:15px;">ğŸ“„ è¯ä¹¦è¯¦ç»†ä¿¡æ¯</h4>`;
                        
                        // è¯ä¹¦é¢å‘è€…
                        if (certInfo.issuer) {
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">é¢å‘è€…ï¼š</span>`;
                            details += `<span class="ssl-certificate-value">${certInfo.issuer}</span>`;
                            details += `</div>`;
                        }
                        
                        // è¯ä¹¦ä¸»é¢˜
                        if (certInfo.subject) {
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">è¯ä¹¦ä¸»é¢˜ï¼š</span>`;
                            details += `<span class="ssl-certificate-value">${certInfo.subject}</span>`;
                            details += `</div>`;
                        }
                        
                        // è¯ä¹¦åºåˆ—å·
                        if (certInfo.serialNumber) {
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">åºåˆ—å·ï¼š</span>`;
                            details += `<span class="ssl-certificate-value">${certInfo.serialNumber}</span>`;
                            details += `</div>`;
                        }
                        
                        // è¯ä¹¦ç”Ÿæˆæ—¶é—´
                        if (certInfo.validFrom) {
                            const fromDate = new Date(certInfo.validFrom);
                            const formattedFromDate = fromDate.toLocaleDateString('zh-CN', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">è¯ä¹¦ç”Ÿæ•ˆæ—¶é—´ï¼š</span>`;
                            details += `<span class="ssl-certificate-value">${formattedFromDate}</span>`;
                            details += `</div>`;
                        }
                        
                        // è¯ä¹¦åˆ°æœŸæ—¶é—´
                        if (certInfo.validTo) {
                            const toDate = new Date(certInfo.validTo);
                            const now = new Date();
                            const daysLeft = Math.ceil((toDate - now) / (1000 * 60 * 60 * 24));
                            
                            const formattedToDate = toDate.toLocaleDateString('zh-CN', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            
                            let statusClass = 'success';
                            let statusText = `${formattedToDate} (å‰©ä½™${daysLeft}å¤©)`;
                            
                            if (daysLeft < 0) {
                                statusClass = 'warning';
                                statusText = `${formattedToDate} (å·²è¿‡æœŸ${Math.abs(daysLeft)}å¤©)`;
                                this.errors.push('SSLè¯ä¹¦å·²è¿‡æœŸ');
                                this.recommendations.push('ç«‹å³æ›´æ–°SSLè¯ä¹¦');
                            } else if (daysLeft < 7) {
                                statusClass = 'warning';
                                statusText = `${formattedToDate} (ä»…å‰©${daysLeft}å¤©)`;
                                this.errors.push('SSLè¯ä¹¦å³å°†è¿‡æœŸ');
                                this.recommendations.push('ç«‹å³æ›´æ–°SSLè¯ä¹¦');
                            } else if (daysLeft < 30) {
                                statusClass = 'warning';
                                statusText = `${formattedToDate} (å‰©ä½™${daysLeft}å¤©)`;
                                this.recommendations.push('å‡†å¤‡æ›´æ–°SSLè¯ä¹¦');
                            }
                            
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">è¯ä¹¦åˆ°æœŸæ—¶é—´ï¼š</span>`;
                            details += `<span class="ssl-certificate-value ${statusClass}">${statusText}</span>`;
                            details += `</div>`;
                            
                            // è¯ä¹¦æœ‰æ•ˆæœŸé•¿åº¦
                            const validDays = Math.ceil((toDate - new Date(certInfo.validFrom)) / (1000 * 60 * 60 * 24));
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">è¯ä¹¦æœ‰æ•ˆæœŸï¼š</span>`;
                            details += `<span class="ssl-certificate-value">${validDays}å¤©</span>`;
                            details += `</div>`;
                        }
                        
                        // è¯ä¹¦æŒ‡çº¹
                        if (certInfo.fingerprint) {
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">è¯ä¹¦æŒ‡çº¹ï¼š</span>`;
                            details += `<span class="ssl-certificate-value">${certInfo.fingerprint}</span>`;
                            details += `</div>`;
                        }
                        
                        // è¯ä¹¦ç®—æ³•
                        if (certInfo.algorithm) {
                            details += `<div class="ssl-certificate-row">`;
                            details += `<span class="ssl-certificate-label">ç­¾åç®—æ³•ï¼š</span>`;
                            details += `<span class="ssl-certificate-value">${certInfo.algorithm}</span>`;
                            details += `</div>`;
                        }
                        
                        details += `</div>`;
                        
                        // è¯ä¹¦çŠ¶æ€åˆ†æ
                        if (certInfo.validTo) {
                            const toDate = new Date(certInfo.validTo);
                            const now = new Date();
                            const daysLeft = Math.ceil((toDate - now) / (1000 * 60 * 60 * 24));
                            
                            details += `<div style="margin-top:20px;">`;
                            
                            if (daysLeft < 0) {
                                details += `<div style="background:linear-gradient(135deg,#fef2f2 0%,#fee2e2 100%);padding:15px;border-radius:8px;border:1px solid #fecaca;color:#dc2626;">`;
                                details += `âŒ <strong>è¯ä¹¦çŠ¶æ€ï¼šå·²è¿‡æœŸ</strong><br>`;
                                details += `SSLè¯ä¹¦å·²äº${Math.abs(daysLeft)}å¤©å‰è¿‡æœŸï¼Œè¯·ç«‹å³è”ç³»è¯ä¹¦é¢å‘æœºæ„æ›´æ–°è¯ä¹¦ã€‚`;
                                details += `</div>`;
                            } else if (daysLeft < 7) {
                                details += `<div style="background:linear-gradient(135deg,#fffbeb 0%,#fef3c7 100%);padding:15px;border-radius:8px;border:1px solid #fbbf24;color:#92400e;">`;
                                details += `âš ï¸ <strong>è¯ä¹¦çŠ¶æ€ï¼šå³å°†è¿‡æœŸ</strong><br>`;
                                details += `SSLè¯ä¹¦å°†åœ¨${daysLeft}å¤©åè¿‡æœŸï¼Œå»ºè®®ç«‹å³æ›´æ–°ä»¥é¿å…æœåŠ¡ä¸­æ–­ã€‚`;
                                details += `</div>`;
                            } else if (daysLeft < 30) {
                                details += `<div style="background:linear-gradient(135deg,#fffbeb 0%,#fef3c7 100%);padding:15px;border-radius:8px;border:1px solid #fbbf24;color:#92400e;">`;
                                details += `âš ï¸ <strong>è¯ä¹¦çŠ¶æ€ï¼šå³å°†åˆ°æœŸ</strong><br>`;
                                details += `SSLè¯ä¹¦å°†åœ¨${daysLeft}å¤©åè¿‡æœŸï¼Œè¯·æå‰å‡†å¤‡æ›´æ–°ã€‚`;
                                details += `</div>`;
                            } else {
                                details += `<div style="background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);padding:15px;border-radius:8px;border:1px solid #a7f3d0;color:#065f46;">`;
                                details += `âœ… <strong>è¯ä¹¦çŠ¶æ€ï¼šæ­£å¸¸</strong><br>`;
                                details += `SSLè¯ä¹¦æœ‰æ•ˆï¼Œè¿˜æœ‰${daysLeft}å¤©è¿‡æœŸã€‚`;
                                details += `</div>`;
                            }
                            
                            details += `</div>`;
                        }
                        
                    } else {
                        // å¦‚æœè¯¦ç»†æ£€æµ‹å¤±è´¥ï¼Œä½¿ç”¨åŸºæœ¬æ£€æµ‹
                        details += await this.basicSSLTest();
                    }
                    
                    // æ·»åŠ æ›´å¤šSSLæ£€æµ‹å·¥å…·é“¾æ¥
                    details += `<div style="background:#f0f9ff;padding:15px;border-radius:6px;border:1px solid #bae6fd;margin-top:20px;">`;
                    details += `<strong>ğŸ’¡ æ›´å¤šSSLæ£€æµ‹å·¥å…·ï¼š</strong><br>`;
                    details += `â€¢ <a href="https://www.ssllabs.com/ssltest/analyze.html?d=${this.domain}" target="_blank" style="color:#0369a1;">Qualys SSL Labs SSL Server Test</a> - æœ€æƒå¨çš„SSLæ£€æµ‹å·¥å…·<br>`;
                    details += `â€¢ <a href="https://check-your-website.server-daten.de/?q=${this.domain}" target="_blank" style="color:#0369a1;">SSL Checker</a> - å¿«é€ŸSSLè¯ä¹¦ä¿¡æ¯æŸ¥è¯¢<br>`;
                    details += `â€¢ <a href="https://crt.sh/?q=${this.domain}" target="_blank" style="color:#0369a1;">crt.sh Certificate Search</a> - è¯ä¹¦é€æ˜åº¦æ—¥å¿—æŸ¥è¯¢<br>`;
                    details += `â€¢ <a href="https://www.sslshopper.com/ssl-checker.html#hostname=${this.domain}" target="_blank" style="color:#0369a1;">SSL Shopper SSL Checker</a> - å¤šç»´åº¦SSLæ£€æµ‹`;
                    details += `</div>`;
                    
                    return { ssl: { status: 'success', details, certInfo } };
                    
                } catch (error) {
                    console.error('SSLæ£€æµ‹é”™è¯¯:', error);
                    return { 
                        ssl: { 
                            status: 'warning', 
                            details: `SSLè¯ä¹¦æ£€æµ‹é‡åˆ°é—®é¢˜: ${error.message}` 
                        } 
                    };
                }
            }
            
            // è·å–SSLè¯ä¹¦ä¿¡æ¯çš„å¢å¼ºæ–¹æ³•
            async getCertificateInfo() {
                try {
                    // åˆ›å»ºiframeæ¥è·å–è¯ä¹¦ä¿¡æ¯ï¼ˆè·¨åŸŸé™åˆ¶ä¸‹çš„å˜é€šæ–¹æ³•ï¼‰
                    return await new Promise((resolve, reject) => {
                        const iframe = document.createElement('iframe');
                        iframe.style.display = 'none';
                        iframe.src = `https://${this.domain}`;
                        
                        iframe.onload = () => {
                            try {
                                // å°è¯•ä»iframeçš„contentWindowè·å–è¯ä¹¦ä¿¡æ¯
                                const certInfo = {
                                    success: true,
                                    issuer: 'éœ€è¦HTTPSè¿æ¥è·å–',
                                    subject: this.domain,
                                    validFrom: 'éœ€è¦HTTPSè¿æ¥è·å–',
                                    validTo: 'éœ€è¦HTTPSè¿æ¥è·å–',
                                    serialNumber: 'N/A',
                                    fingerprint: 'N/A',
                                    algorithm: 'N/A',
                                    source: 'æµè§ˆå™¨å®‰å…¨é™åˆ¶'
                                };
                                
                                // æ¸…ç†iframe
                                document.body.removeChild(iframe);
                                resolve(certInfo);
                            } catch (e) {
                                document.body.removeChild(iframe);
                                reject(new Error('æ— æ³•è·å–è¯ä¹¦ä¿¡æ¯ï¼šæµè§ˆå™¨å®‰å…¨é™åˆ¶'));
                            }
                        };
                        
                        iframe.onerror = () => {
                            document.body.removeChild(iframe);
                            reject(new Error('æ— æ³•åŠ è½½ç½‘ç«™'));
                        };
                        
                        document.body.appendChild(iframe);
                        
                        // è®¾ç½®è¶…æ—¶
                        setTimeout(() => {
                            if (iframe.parentNode) {
                                document.body.removeChild(iframe);
                            }
                            reject(new Error('è·å–è¯ä¹¦ä¿¡æ¯è¶…æ—¶'));
                        }, 10000);
                    });
                    
                } catch (error) {
                    console.log('é«˜çº§è¯ä¹¦æ£€æµ‹å¤±è´¥ï¼Œä½¿ç”¨å¤‡é€‰æ–¹æ¡ˆ:', error);
                    
                    // å¤‡é€‰æ–¹æ¡ˆï¼šä½¿ç”¨å…¬å¼€çš„è¯ä¹¦é€æ˜åº¦æ—¥å¿—API
                    try {
                        const response = await fetch(`https://crt.sh/json?q=${this.domain}&output=json`);
                        if (response.ok) {
                            const certificates = await response.json();
                            
                            if (certificates && certificates.length > 0) {
                                // å–æœ€æ–°çš„è¯ä¹¦
                                const latestCert = certificates.sort((a, b) => 
                                    new Date(b.not_after) - new Date(a.not_after)
                                )[0];
                                
                                return {
                                    success: true,
                                    issuer: latestCert.issuer_name || 'æœªçŸ¥',
                                    subject: latestCert.common_name || this.domain,
                                    validFrom: latestCert.not_before || new Date().toISOString(),
                                    validTo: latestCert.not_after || new Date(Date.now() + 90*24*60*60*1000).toISOString(),
                                    serialNumber: latestCert.serial_number || 'N/A',
                                    fingerprint: 'éœ€è¦åŸå§‹è¯ä¹¦è®¡ç®—',
                                    algorithm: 'éœ€è¦åŸå§‹è¯ä¹¦è§£æ',
                                    source: 'crt.shè¯ä¹¦é€æ˜åº¦æ—¥å¿—'
                                };
                            }
                        }
                    } catch (apiError) {
                        console.log('crt.sh APIå¤±è´¥:', apiError);
                    }
                    
                    // æœ€åçš„å¤‡é€‰æ–¹æ¡ˆï¼šä½¿ç”¨åŸºæœ¬HTTPSæµ‹è¯•
                    return null;
                }
            }
            
            async checkDNS() {
                try {
                    const response = await fetch(
                        `https://cloudflare-dns.com/dns-query?name=${this.domain}&type=A`,
                        { 
                            headers: { 'Accept': 'application/dns-json' }
                        }
                    );
                    
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    
                    const data = await response.json();
                    
                    let status = 'success';
                    let details = `ğŸ” DNSè§£ææŸ¥è¯¢ç»“æœ:\n\n`;
                    
                    if (data.Status === 0 && data.Answer && data.Answer.length > 0) {
                        const ips = data.Answer.map(a => `${a.data} (TTL: ${a.TTL}s)`).join('\n');
                        details += `âœ… Aè®°å½•è§£ææˆåŠŸ:\n${ips}\n`;
                        
                        this.ips = data.Answer.map(a => a.data);
                        
                        if (data.Answer.length > 1) {
                            details += `ğŸ”€ æ£€æµ‹åˆ°${data.Answer.length}ä¸ªIPï¼Œå¯èƒ½ä½¿ç”¨CDNæˆ–è´Ÿè½½å‡è¡¡\n`;
                        }
                        
                    } else if (data.Answer && data.Answer.length === 0) {
                        status = 'error';
                        details += `âŒ æ²¡æœ‰æ‰¾åˆ°Aè®°å½•\n`;
                        this.errors.push('DNS Aè®°å½•ä¸å­˜åœ¨');
                    } else {
                        status = 'error';
                        details += `âŒ DNSè§£æå¤±è´¥ (çŠ¶æ€ç : ${data.Status})\n`;
                        this.errors.push('DNSè§£æå¤±è´¥');
                    }
                    
                    return { dns: { status, details, raw: data } };
                    
                } catch (error) {
                    return { 
                        dns: { 
                            status: 'error', 
                            details: `DNSæŸ¥è¯¢å¤±è´¥: ${error.message}\n\nè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åŸŸåæ˜¯å¦æ­£ç¡®ã€‚` 
                        } 
                    };
                }
            }
            
            async fullDNSLookup() {
                try {
                    let details = `ğŸ”¬ å®Œæ•´DNSè§£æè®°å½•:\n\n`;
                    
                    const recordTypes = [
                        { type: 'A', name: 'Aè®°å½• (IPv4åœ°å€)' },
                        { type: 'AAAA', name: 'AAAAè®°å½• (IPv6åœ°å€)' },
                        { type: 'CNAME', name: 'CNAMEè®°å½• (åˆ«å)' },
                        { type: 'MX', name: 'MXè®°å½• (é‚®ä»¶æœåŠ¡å™¨)' },
                        { type: 'TXT', name: 'TXTè®°å½• (æ–‡æœ¬è®°å½•)' },
                        { type: 'NS', name: 'NSè®°å½• (åŸŸåæœåŠ¡å™¨)' },
                        { type: 'SOA', name: 'SOAè®°å½• (æˆæƒèµ·å§‹)' }
                    ];
                    
                    const records = [];
                    
                    for (const { type, name } of recordTypes) {
                        try {
                            const response = await fetch(
                                `https://cloudflare-dns.com/dns-query?name=${this.domain}&type=${type}`,
                                { 
                                    headers: { 'Accept': 'application/dns-json' },
                                    signal: AbortSignal.timeout(5000)
                                }
                            );
                            
                            if (response.ok) {
                                const data = await response.json();
                                if (data.Status === 0 && data.Answer && data.Answer.length > 0) {
                                    records.push({ type, name, data: data.Answer });
                                }
                            }
                        } catch (error) {
                            // å¿½ç•¥
                        }
                    }
                    
                    if (records.length > 0) {
                        details += '<table style="width:100%;border-collapse:collapse;margin:15px 0;">';
                        details += '<tr><th style="background:#f8fafc;padding:8px;border:1px solid #e2e8f0;">è®°å½•ç±»å‹</th><th style="background:#f8fafc;padding:8px;border:1px solid #e2e8f0;">æ•°é‡</th><th style="background:#f8fafc;padding:8px;border:1px solid #e2e8f0;">è¯¦ç»†å€¼</th></tr>';
                        
                        records.forEach(record => {
                            const values = record.data.map(r => {
                                let val = r.data;
                                if (record.type === 'MX') {
                                    const parts = r.data.split(' ');
                                    val = `ä¼˜å…ˆçº§: ${parts[0]}, æœåŠ¡å™¨: ${parts.slice(1).join(' ')}`;
                                }
                                return `${val} (TTL: ${r.TTL}s)`;
                            }).join('<br>');
                            
                            details += `<tr>
                                <td style="padding:8px;border:1px solid #e2e8f0;"><strong>${record.name}</strong></td>
                                <td style="padding:8px;border:1px solid #e2e8f0;">${record.data.length}</td>
                                <td style="padding:8px;border:1px solid #e2e8f0;">${values}</td>
                            </tr>`;
                        });
                        
                        details += '</table>';
                        
                        // åˆ†æDNSé…ç½®
                        details += '<div style="background:#f0f9ff;padding:15px;border-radius:6px;border:1px solid #bae6fd;margin-top:15px;">';
                        details += '<strong>ğŸ“Š DNSé…ç½®åˆ†æï¼š</strong><br>';
                        
                        const hasA = records.some(r => r.type === 'A');
                        const hasAAAA = records.some(r => r.type === 'AAAA');
                        const hasCNAME = records.some(r => r.type === 'CNAME');
                        const hasMX = records.some(r => r.type === 'MX');
                        const hasTXT = records.some(r => r.type === 'TXT');
                        
                        if (hasA) details += 'âœ… å·²é…ç½®IPv4åœ°å€<br>';
                        else details += 'âš ï¸ æœªé…ç½®IPv4åœ°å€<br>';
                        
                        if (hasAAAA) details += 'âœ… å·²é…ç½®IPv6åœ°å€<br>';
                        else details += 'ğŸ’¡ å»ºè®®é…ç½®IPv6åœ°å€<br>';
                        
                        if (hasMX) details += 'âœ… å·²é…ç½®é‚®ä»¶æœåŠ¡å™¨<br>';
                        else details += 'ğŸ’¡ æœªé…ç½®é‚®ä»¶æœåŠ¡å™¨<br>';
                        
                        if (hasTXT) details += 'âœ… å·²é…ç½®TXTè®°å½•<br>';
                        else details += 'ğŸ’¡ å»ºè®®é…ç½®TXTè®°å½•ï¼ˆSPFã€DMARCç­‰ï¼‰<br>';
                        
                        if (hasCNAME) details += 'âš ï¸ å­˜åœ¨CNAMEè®°å½•ï¼Œæ³¨æ„è§£æä¼˜å…ˆçº§<br>';
                        
                        details += '</div>';
                        
                    } else {
                        details += '<div style="background:linear-gradient(135deg,#fef2f2 0%,#fee2e2 100%);padding:20px;border-radius:8px;border:1px solid #fecaca;">';
                        details += 'âŒ æœªæŸ¥è¯¢åˆ°ä»»ä½•DNSè®°å½•<br>';
                        details += 'å¯èƒ½åŸå› ï¼š<br>';
                        details += '1. åŸŸåæœªé…ç½®DNSè§£æ<br>';
                        details += '2. åŸŸåä¸å­˜åœ¨æˆ–å·²è¿‡æœŸ<br>';
                        details += '3. DNSæŸ¥è¯¢æœåŠ¡æš‚æ—¶ä¸å¯ç”¨<br>';
                        details += 'å»ºè®®ï¼šæ£€æŸ¥åŸŸåçŠ¶æ€å¹¶æ­£ç¡®é…ç½®DNSè§£æ';
                        details += '</div>';
                        
                        this.errors.push('DNSè§£æè®°å½•ä¸ºç©º');
                    }
                    
                    return { dnsFull: { status: records.length > 0 ? 'success' : 'error', details } };
                    
                } catch (error) {
                    return { 
                        dnsFull: { 
                            status: 'error', 
                            details: `å®Œæ•´DNSæŸ¥è¯¢å¤±è´¥: ${error.message}` 
                        } 
                    };
                }
            }
            
            async checkHTTP() {
                try {
                    const results = {};
                    let details = '';
                    let overallStatus = 'success';
                    
                    try {
                        const startTime = Date.now();
                        await fetch(`http://${this.domain}`, {
                            method: 'HEAD',
                            mode: 'no-cors'
                        });
                        const time = Date.now() - startTime;
                        
                        results.http = { success: true, time };
                        details += `ğŸŒ HTTPæ£€æµ‹:\n  âœ… è¿æ¥æˆåŠŸ (${time}ms)\n`;
                        
                    } catch (error) {
                        results.http = { success: false };
                        details += `ğŸŒ HTTPæ£€æµ‹:\n  âŒ è¿æ¥å¤±è´¥\n`;
                        overallStatus = 'warning';
                    }
                    
                    try {
                        const startTime = Date.now();
                        await fetch(`https://${this.domain}`, {
                            method: 'HEAD',
                            mode: 'no-cors'
                        });
                        const time = Date.now() - startTime;
                        
                        results.https = { success: true, time };
                        details += `ğŸ”’ HTTPSæ£€æµ‹:\n  âœ… è¿æ¥æˆåŠŸ (${time}ms)\n`;
                        
                    } catch (error) {
                        results.https = { success: false };
                        details += `ğŸ”’ HTTPSæ£€æµ‹:\n  âŒ è¿æ¥å¤±è´¥\n`;
                        overallStatus = overallStatus === 'warning' ? 'error' : 'warning';
                    }
                    
                    // æ·»åŠ å»ºè®®
                    if (results.https && results.https.success) {
                        details += '\nğŸ’¡ ç½‘ç«™å·²å¯ç”¨HTTPSï¼Œå®‰å…¨æ€§è‰¯å¥½\n';
                    } else if (results.http && results.http.success) {
                        details += '\nâš ï¸ ç½‘ç«™ä»…æ”¯æŒHTTPï¼Œå»ºè®®å¯ç”¨HTTPSåŠ å¯†\n';
                        this.recommendations.push('ä¸ºç½‘ç«™å¯ç”¨HTTPSåŠ å¯†');
                    }
                    
                    return { http: { status: overallStatus, details, results } };
                    
                } catch (error) {
                    return { 
                        http: { 
                            status: 'error', 
                            details: `HTTP/HTTPSæ£€æµ‹å¤±è´¥: ${error.message}` 
                        } 
                    };
                }
            }
            
            async checkPing() {
                try {
                    let details = `ğŸ“¡ ç½‘ç»œè¿é€šæ€§æµ‹è¯•:\n\n`;
                    
                    try {
                        const startTime = Date.now();
                        await fetch(`https://${this.domain}/favicon.ico`, {
                            method: 'HEAD',
                            mode: 'no-cors'
                        });
                        const time = Date.now() - startTime;
                        
                        details += `<div style="background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);padding:15px;border-radius:8px;border:1px solid #a7f3d0;">`;
                        details += `âœ… <strong>æœåŠ¡å™¨å¯è¾¾</strong><br>`;
                        details += `â±ï¸ <strong>å“åº”æ—¶é—´:</strong> ${time}ms<br><br>`;
                        
                        if (time < 100) {
                            details += `âš¡ <strong>é€Ÿåº¦è¯„ä»·:</strong> æå¿«ï¼Œç”¨æˆ·ä½“éªŒä¼˜ç§€\n`;
                        } else if (time < 300) {
                            details += `ğŸ‘ <strong>é€Ÿåº¦è¯„ä»·:</strong> è‰¯å¥½ï¼Œç”¨æˆ·ä½“éªŒæ­£å¸¸\n`;
                        } else if (time < 1000) {
                            details += `âš ï¸ <strong>é€Ÿåº¦è¯„ä»·:</strong> è¾ƒæ…¢ï¼Œå¯èƒ½å½±å“éƒ¨åˆ†ç”¨æˆ·ä½“éªŒ\n`;
                        } else {
                            details += `âŒ <strong>é€Ÿåº¦è¯„ä»·:</strong> éå¸¸æ…¢ï¼Œä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒ\n`;
                            this.recommendations.push('ä¼˜åŒ–æœåŠ¡å™¨å“åº”é€Ÿåº¦');
                        }
                        
                        details += `</div>`;
                        
                        return { ping: { status: 'success', details, time } };
                        
                    } catch (error) {
                        details += `<div style="background:linear-gradient(135deg,#fef2f2 0%,#fee2e2 100%);padding:15px;border-radius:8px;border:1px solid #fecaca;">`;
                        details += `âŒ <strong>æœåŠ¡å™¨ä¸å¯è¾¾</strong><br>`;
                        details += `å¯èƒ½åŸå› ï¼š<br>`;
                        details += `1. æœåŠ¡å™¨å·²å…³æœºæˆ–å®•æœº<br>`;
                        details += `2. é˜²ç«å¢™é˜»æ­¢äº†è¿æ¥<br>`;
                        details += `3. åŸŸåè§£æåˆ°é”™è¯¯çš„IP<br>`;
                        details += `4. ç½‘ç»œè¿æ¥é—®é¢˜<br>`;
                        details += `å»ºè®®ï¼šæ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€å’Œç½‘ç»œé…ç½®`;
                        details += `</div>`;
                        
                        this.errors.push('æœåŠ¡å™¨ç½‘ç»œä¸å¯è¾¾');
                        return { ping: { status: 'error', details } };
                    }
                    
                } catch (error) {
                    return { 
                        ping: { 
                            status: 'error', 
                            details: `ç½‘ç»œè¿é€šæ€§æµ‹è¯•å¤±è´¥: ${error.message}` 
                        } 
                    };
                }
            }
            
            analyzeFaults() {
                let faultAnalysis = '';
                
                if (this.errors.length > 0) {
                    faultAnalysis += `ğŸ”´ <strong>å‘ç°${this.errors.length}ä¸ªé—®é¢˜:</strong>\n`;
                    this.errors.forEach(error => {
                        faultAnalysis += `   â€¢ ${error}\n`;
                    });
                    
                    faultAnalysis += `\n<strong>æ•…éšœå¯èƒ½åŸå› åˆ†æ:</strong>\n`;
                    
                    if (this.errors.includes('DNSè§£æå¤±è´¥') || this.errors.includes('DNS Aè®°å½•ä¸å­˜åœ¨')) {
                        faultAnalysis += `â€¢ DNSé…ç½®é”™è¯¯æˆ–åŸŸåæœªè§£æ\n`;
                    }
                    if (this.errors.includes('æœåŠ¡å™¨ç½‘ç»œä¸å¯è¾¾')) {
                        faultAnalysis += `â€¢ æœåŠ¡å™¨ç¦»çº¿æˆ–ç½‘ç»œæ•…éšœ\n`;
                    }
                    if (this.errors.includes('SSLè¯ä¹¦é—®é¢˜') || this.errors.includes('SSLè¯ä¹¦å·²è¿‡æœŸ') || this.errors.includes('SSLè¯ä¹¦å³å°†è¿‡æœŸ')) {
                        faultAnalysis += `â€¢ SSLè¯ä¹¦é…ç½®é”™è¯¯æˆ–è¿‡æœŸ\n`;
                    }
                    
                } else {
                    faultAnalysis += `<div style="background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);padding:20px;border-radius:8px;border:1px solid #a7f3d0;">`;
                    faultAnalysis += `âœ… <strong>åŸŸåçŠ¶æ€æ­£å¸¸</strong>\n`;
                    faultAnalysis += `æ‰€æœ‰åŸºç¡€æ£€æµ‹é¡¹ç›®å‡é€šè¿‡ï¼Œç½‘ç«™å¯æ­£å¸¸è®¿é—®ã€‚`;
                    faultAnalysis += `</div>`;
                }
                
                this.faultAnalysis = faultAnalysis;
            }
            
            displayResults() {
                if (!this.resultsContainer) return;
                
                const totalTests = Object.keys(this.results).length;
                const successTests = Object.values(this.results).filter(r => r.status === 'success').length;
                const errorTests = Object.values(this.results).filter(r => r.status === 'error').length;
                const warningTests = Object.values(this.results).filter(r => r.status === 'warning').length;
                
                let summaryHtml = `
                    <div class="summary">
                        <h3>ğŸ“Š è¯Šæ–­æŠ¥å‘Šæ‘˜è¦</h3>
                        <p><strong>è¯Šæ–­åŸŸå:</strong> ${this.domain}</p>
                        <p><strong>è¯Šæ–­æ—¶é—´:</strong> ${new Date().toLocaleString('zh-CN')}</p>
                        <p><strong>æ£€æµ‹é¡¹ç›®:</strong> ${totalTests}é¡¹</p>
                        <p><strong>é€šè¿‡:</strong> ${successTests}é¡¹ | <strong>è­¦å‘Š:</strong> ${warningTests}é¡¹ | <strong>é”™è¯¯:</strong> ${errorTests}é¡¹</p>
                `;
                
                if (errorTests === 0 && warningTests === 0) {
                    summaryHtml += `<p>ğŸ‰ åŸŸåçŠ¶æ€ä¼˜ç§€ï¼Œæ‰€æœ‰æ£€æµ‹é¡¹ç›®æ­£å¸¸</p>`;
                } else if (errorTests > 0) {
                    summaryHtml += `<p>ğŸ”´ å‘ç°${errorTests}ä¸ªä¸¥é‡é—®é¢˜ï¼Œéœ€è¦ç«‹å³å¤„ç†</p>`;
                } else if (warningTests > 0) {
                    summaryHtml += `<p>ğŸŸ¡ å‘ç°${warningTests}ä¸ªè­¦å‘Šé¡¹ç›®ï¼Œå»ºè®®ä¼˜åŒ–</p>`;
                }
                
                summaryHtml += `</div>`;
                
                let faultHtml = '';
                if (this.faultAnalysis) {
                    const faultStatus = this.errors.length > 0 ? 'error' : 'success';
                    faultHtml = `
                        <div class="test-item ${faultStatus}">
                            <div class="test-header">
                                <div class="test-title">ğŸ” æ•…éšœåŸå› åˆ†æ</div>
                                <div class="test-status status-${faultStatus}">
                                    ${this.errors.length > 0 ? 'å‘ç°æ•…éšœ' : 'è¿è¡Œæ­£å¸¸'}
                                </div>
                            </div>
                            <div class="test-details">${this.faultAnalysis}</div>
                        </div>
                    `;
                }
                
                let errorsHtml = '';
                if (this.errors.length > 0) {
                    errorsHtml = `
                        <div class="error-list">
                            <h3>âŒ å‘ç°çš„é—®é¢˜ (${this.errors.length}ä¸ª)</h3>
                            ${this.errors.map(error => `<div class="error-item">â€¢ ${error}</div>`).join('')}
                        </div>
                    `;
                }
                
                let recommendationsHtml = '';
                if (this.recommendations.length > 0) {
                    recommendationsHtml = `
                        <div class="recommendations">
                            <h3>ğŸ’¡ ä¼˜åŒ–å»ºè®® (${this.recommendations.length}æ¡)</h3>
                            ${this.recommendations.map(rec => `<div>â€¢ ${rec}</div>`).join('')}
                        </div>
                    `;
                }
                
                let detailsHtml = '';
                const testOrder = ['dns', 'dnsFull', 'http', 'ssl', 'whois', 'ping'];
                const testNames = {
                    dns: 'ğŸŒ åŸºç¡€DNSè§£æ',
                    dnsFull: 'ğŸ” å®Œæ•´DNSè§£æ',
                    http: 'ğŸ”— HTTP/HTTPSæ£€æµ‹',
                    ssl: 'ğŸ”’ SSLè¯ä¹¦æ£€æµ‹',
                    whois: 'ğŸ“‹ WHOISä¿¡æ¯',
                    ping: 'ğŸ“¡ ç½‘ç»œè¿é€šæ€§'
                };
                
                testOrder.forEach(key => {
                    const result = this.results[key];
                    if (result) {
                        const statusClass = result.status;
                        const statusText = result.status === 'success' ? 'é€šè¿‡' : 
                                        result.status === 'error' ? 'å¤±è´¥' : 'è­¦å‘Š';
                        
                        detailsHtml += `
                            <div class="test-item ${statusClass}">
                                <div class="test-header">
                                    <div class="test-title">${testNames[key]}</div>
                                    <div class="test-status status-${statusClass}">${statusText}</div>
                                </div>
                                <div class="test-details">${result.details}</div>
                            </div>
                        `;
                    }
                });
                
                this.resultsContainer.innerHTML = summaryHtml + faultHtml + errorsHtml + recommendationsHtml + detailsHtml;
            }
            
            async basicSSLTest() {
                let details = '';
                
                try {
                    const startTime = Date.now();
                    await fetch(`https://${this.domain}`, { 
                        mode: 'no-cors'
                    });
                    const time = Date.now() - startTime;
                    
                    details += `<div style="background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);padding:15px;border-radius:8px;border:1px solid #a7f3d0;">`;
                    details += `âœ… <strong>SSLè¯ä¹¦åŸºæœ¬æœ‰æ•ˆ</strong><br>`;
                    details += `ğŸ”’ <strong>HTTPSè¿æ¥æˆåŠŸå»ºç«‹</strong><br>`;
                    details += `â±ï¸ <strong>SSLæ¡æ‰‹æ—¶é—´:</strong> ${time}ms<br><br>`;
                    
                    if (time < 200) {
                        details += `âš¡ <strong>SSLæ€§èƒ½:</strong> ä¼˜ç§€\n`;
                    } else if (time < 500) {
                        details += `ğŸ‘ <strong>SSLæ€§èƒ½:</strong> è‰¯å¥½\n`;
                    } else {
                        details += `âš ï¸ <strong>SSLæ€§èƒ½:</strong> è¾ƒæ…¢ï¼Œè€ƒè™‘ä¼˜åŒ–SSLé…ç½®\n`;
                        this.recommendations.push('ä¼˜åŒ–SSL/TLSé…ç½®');
                    }
                    
                    details += `</div>`;
                    
                    // æ·»åŠ è¯´æ˜
                    details += `<div style="background:#f8fafc;padding:12px;border-radius:6px;border:1px solid #e2e8f0;margin-top:10px;">`;
                    details += `ğŸ’¡ <strong>è¯´æ˜ï¼š</strong>ç”±äºæµè§ˆå™¨å®‰å…¨é™åˆ¶ï¼Œæ— æ³•ç›´æ¥è·å–è¯ä¹¦çš„è¯¦ç»†ç”Ÿæ•ˆ/åˆ°æœŸæ—¶é—´ã€‚<br>`;
                    details += `å¦‚éœ€æŸ¥çœ‹å®Œæ•´çš„è¯ä¹¦ä¿¡æ¯ï¼ˆåŒ…æ‹¬é¢å‘æ—¶é—´ã€åˆ°æœŸæ—¶é—´ç­‰ï¼‰ï¼Œè¯·ä½¿ç”¨ä¸“é—¨çš„SSLæ£€æµ‹å·¥å…·ã€‚`;
                    details += `</div>`;
                    
                } catch (error) {
                    details += `<div style="background:linear-gradient(135deg,#fef2f2 0%,#fee2e2 100%);padding:15px;border-radius:8px;border:1px solid #fecaca;">`;
                    details += `âŒ <strong>SSLè¯ä¹¦æ£€æµ‹å¤±è´¥</strong><br>`;
                    details += `å¯èƒ½åŸå› ï¼š<br>`;
                    details += `1. ç½‘ç«™æœªå¯ç”¨HTTPS<br>`;
                    details += `2. SSLè¯ä¹¦è¿‡æœŸ<br>`;
                    details += `3. SSLè¯ä¹¦é…ç½®é”™è¯¯<br>`;
                    details += `4. ä½¿ç”¨è‡ªç­¾åè¯ä¹¦<br>`;
                    details += `å»ºè®®ï¼šæ£€æŸ¥SSLè¯ä¹¦é…ç½®æˆ–è”ç³»ä¸»æœºå•†`;
                    details += `</div>`;
                    
                    this.errors.push('SSLè¯ä¹¦é—®é¢˜');
                    throw error;
                }
                
                return details;
            }
        }
        
        const diagnostic = new ProfessionalDomainDiagnostic();
        
        async function startDiagnosis() {
            const domainInput = document.getElementById('domainInput');
            const domain = domainInput.value.trim();
            
            if (!domain) {
                diagnostic.showError('è¯·è¾“å…¥è¦è¯Šæ–­çš„åŸŸå');
                return;
            }
            
            const domainRegex = /^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/;
            if (!domainRegex.test(domain)) {
                diagnostic.showError('è¯·è¾“å…¥æœ‰æ•ˆçš„åŸŸåæ ¼å¼ï¼ˆå¦‚ï¼šexample.comï¼‰');
                return;
            }
            
            await diagnostic.startDiagnosis(domain);
        }
        
        document.getElementById('domainInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') startDiagnosis();
        });
        
        window.addEventListener('DOMContentLoaded', () => {
            const domainInput = document.getElementById('domainInput');
            if (domainInput) {
                domainInput.focus();
                domainInput.select();
            }
        });
    </script>
</body>
</html>
